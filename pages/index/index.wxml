<wxs module="filter" src="../../utils/numFr.wxs"></wxs>
<view wx:if="{{showPageLoading}}" class="pageLoading">
  <image src="../../images/pageLoading.gif" class="pageLoadingImg"></image>
  <view class="pageLoadingTip" style="color:#666666;font-size: 30rpx;">桔美好生活，集好店优惠</view>
</view>
<view class="{{(slideShowList.length>0||recommendPage.length>0)?'':'homeTabPage'}} {{isShowNewerGet?'noscroll':''}}" wx:else>

  <view wx:if="{{slideShowList.length>0||pointProductList.length>0||recommendPage.length>0}}">
    <view class="toperWrap {{pointProductList.length>0?'pb30':''}}">
      <view class="bgBar"></view>
      <image src="../../images/bgy.png" class="bgy"></image>
      <view class="toper">
        <swiper autoplay="{{autoplay}}" indicator-dots="true" indicator-color="{{dotsColor}}" indicator-active-color="{{dotsActiveColor}}" circular>
          <swiper-item wx:for="{{slideShowList}}" wx:key="unique">
            <image src="{{item.imgId?'https://upic.juniuo.com/file/picture/'+item.imgId+'/resize_0_0/mode_fill':''}}" data-link="{{item.link}}" bindtap="onTapBanner" class="slide-image" mode="scaleToFill"></image>
          </swiper-item>
        </swiper>

        <view class="locationWrap" bindtap="toCityList">
          <text class="locationText">{{locationName}}</text>
          <image style="width:20rpx;height:14rpx;margin-left:12rpx;margin-top:8rpx;" lazy-load="true" src="../../images/sort-down.png" wx:if="{{locationName}}"></image>
        </view>
      </view>
    </view>

     

    <view class="menulist ub ub-ac ub-pj">
      <view class="menuitem ub ub-ver ub-ac ub-pc" bindtap="toPath" data-page="/pages/juzihl/index">
        <image class="icon_home" src="../../images/icon_home1.png"></image>
        <view class="tx-c">桔子换礼</view>
      </view>
      <view class="menuitem ub ub-ver ub-ac ub-pc" bindtap="toPath" data-page="/pages/juzihl/index">
        <image class="icon_home" src="../../images/icon_home2.png"></image>
        <view class="tx-c">特价拼团</view>
      </view>
      <view class="menuitem ub ub-ver ub-ac ub-pc" bindtap="toPath" data-page="/pages/juzihl/index">
        <image class="icon_home" src="../../images/icon_home3.png"></image>
        <view class="tx-c">超值砍价</view>
      </view>
      <view class="menuitem ub ub-ver ub-ac ub-pc" bindtap="toPath" data-page="/pages/juzihl/index">
        <image class="icon_home" src="../../images/icon_home4.png"></image>
        <view class="tx-c">限时秒杀</view>
      </view>
    </view>


    <!-- 桔子球 -->
    <view class="juziqiu" bindtap="onTapJuziqiu">
      <view style="font-size: 24rpx;color: #333333;font-weight:bold;text-align:center;margin-top:24rpx">
        <text style="font-size: 30rpx;color: #151515;">{{filter.toFloor(pointBalance)}}</text>桔子</view>
      <view class="ub ub-ac ub-pc">
        <text style="font-size: 20rpx;color: #333333;">去赚取</text>
        <image src="../../images/toPointList.png" style="width:12rpx;height:17rpx;margin-left:10rpx;"></image>
      </view>
    </view>

    <view class="juzihl-wrap" style="padding-bottom:30rpx">
      <view class="ub ub-fe">
        <view class="mtitle">精选推荐</view>
        <view class="subtitle" style="margin-top:10rpx;">精选好物，先到先得</view>
      </view>

      <view class="labels-wrap">
        <view class="label {{sortIndex==1?'label-active':''}}" data-label="1" bindtap="toggleLabel">
          综合</view>
        <view class="label {{sortIndex==2?'label-active':''}}" data-label="2" bindtap="toggleLabel">
          价格
          <image src="{{sortIndex==2?'../../images/sort_top_active.png':'../../images/sort_top.png'}}" class="xIcon {{sortIndex==2&&sortArray[sortIndex - 1]=='DESC'?'rotate':''}}" style="width:13rpx;height:18rpx;margin-left:10rpx;"></image>
        </view>
        <view class="label {{sortIndex==3?'label-active':''}}" data-label="3" bindtap="toggleLabel">
          距离
          <image src="{{sortIndex==3?'../../images/sort_top_active.png':'../../images/sort_top.png'}}" class="xIcon {{sortIndex==3&&sortArray[sortIndex - 1]=='DESC'?'rotate':''}}" style="width:13rpx;height:18rpx;margin-left:10rpx;"></image>
        </view>
        <view class="label {{sortIndex==4?'label-active':''}}" data-label="4" bindtap="toggleLabel">
          销量
          <image src="{{sortIndex==4?'../../images/label_xl_active.png':'../../images/label_xl.png'}}" style="width:15rpx;height:16rpx;margin-left:10rpx;"></image>
        </view>
      </view>
      <view class="jingxuanlist" wx:for="{{recommendPage}}" wx:key="unique">
        <image class="productImg" bindtap="toComDetail" data-id="{{item.productId}}" data-storeid="{{item.nearStore.id}}" lazy-load="true" src="https://upic.juniuo.com/file/picture/{{item.picId}}/resize_690_387/mode_fill" mode="widthFix"></image>
        <view class="dis-wrap jc-sb">
          <view class="from">{{item.merchantName}}</view>
          <view class="dis">距你{{filter.toDis(item.nearDist)}}km</view>
        </view>
        <view class="pro-name" bindtap="toComDetail" data-id="{{item.productId}}" data-storeid="{{item.nearStore.id}}" style="margin-top:8rpx">{{item.productName}}</view>
        <view class="price-wrap jc-sb">
          <view class="p-wrap">
            <view class="now-price" wx:if="{{item.point>0}}">{{item.point}}</view>
            <view class="now-text" wx:if="{{item.point>0}}">桔子</view>
            <view class="now-text" style="font-size: 28rpx;" wx:if="{{item.point>0&&item.price>0}}">+</view>
            <view class="now-price" wx:if="{{item.price>0}}">{{filter.toFix(item.price)}}</view>
            <view class="now-text" wx:if="{{item.price>0}}">元</view>
            <!-- <view class="old-price">{{filter.toFix(item.originalPrice)}}元</view> -->
            <view class="proDiv ub ub-ac" wx:if="{{item.distributor}}">
              <view class="l">赚</view>
              <view class="r">￥{{filter.toFix(item.distributorSalesRebate)}}</view>
            </view>
          </view>
        </view>
        <view class="ub ub-ac jc-sb" style="padding: 0 30rpx 30rpx 30rpx;">
          <view class="ub ub-ac ub-f1" style="margin-top:20rpx">
            <image src="../../images/soldCount.png" style="width:24rpx;height: 22rpx;"></image>
            <text class="count">已售{{item.soldNum}}件</text>
          </view>
          <button class="ctrlbtn sharBtn" wx:if="{{!item.distributor}}" bindtap="toComDetailAndShare" data-id="{{item.productId}}" data-storeid="{{item.nearStore.id}}">分享</button>
          <button class="ctrlbtn buyBtn1" wx:if="{{!item.distributor}}" bindtap="toComDetail" data-id="{{item.productId}}" data-storeid="{{item.nearStore.id}}">购买</button>
          <button class="ctrlbtn buyBtn2" wx:if="{{item.distributor}}" bindtap="toComDetail" data-id="{{item.productId}}" data-storeid="{{item.nearStore.id}}">购买</button>
          <button class="ctrlbtn proBtn1" wx:if="{{item.distributor}}" bindtap="toPro" data-id="{{item.productId}}">推广</button>
        </view>
      </view>
    </view>

    <view class="phoneWrap" wx:if="{{!pullUpFlag}}">
      <view class="phoneView ub ub-ac" bindtap="callPhone">
        <image src="../../images/logo_main.png" style="width:80rpx;height:80rpx;"></image>
        <view class="phoneInner">
          <view>桔集-桔美好生活，集好店优惠</view>
          <view class="ub ub-ac" style="margin-top: 10rpx;">
            <image src="../../images/dianhua.png" style="width:30rpx;height:26rpx;margin-right:10rpx;"></image>合作电话：400-001-1139</view>
        </view>
      </view>
    </view>

  </view>

  <view style="width:100%;height:100%;background:#ffffff;overflow:hidden;" wx:else>

    <image src="../../images/city.png" style="width:240rpx;height:180rpx;margin:180rpx auto 60rpx;display:block;"></image>
    <view style="font-size: 30rpx;color: #333333;text-align:center;">您的所在的位置暂未开通桔集服务</view>
    <view style="margin-top:160rpx;font-size: 28rpx;color: #666666;text-align:center;">逛一下其他热门城市吧</view>

    <view class="main">
      <view class="citem ub ub-ac ub-pc" wx:for="{{citylist}}" wx:key="unique" bindtap="selectCity" data-name="{{item.locationType=='CITY'?item.locationName:item.subList[0].locationName}}" data-pcode="{{item.locationType=='PROVINCE'?item.locationCode:''}}" data-code="{{item.locationType=='CITY'?item.locationCode:item.subList[0].locationCode}}" style="width:{{imageWidth}}">
        <view wx:if="{{item.locationType=='CITY'}}">{{item.locationName}}</view>
        <view wx:else>{{item.subList[0].locationName}}</view>
      </view>
      <view class="clear"></view>
    </view>
  </view>

    <view class="newerGetModalWrap" wx:if="{{isShowNewerGet}}">
      <view class="newerGetModal">
        <image src="../../images/newerGetBg.png" style="width:680rpx;height:735rpx;"></image>
        <image src="../../images/newerGetBtn.png" class="newerGetBtn" bindtap="closeGetNewer"></image>
        <image src="../../images/newerGetClose.png" class="newerGetClose" bindtap="closeGetNewer"></image>
      </view>
    </view>
</view>